<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeFlow</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap');
        body { font-family: 'Courier Prime', monospace; background-color: #f0f0f0; }
        .typewriter { border-right: .15em solid #333; animation: blink-caret .75s step-end infinite; }
        @keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: #333; } }
    </style>
    <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="manifest" href="site.webmanifest">
</head>
<body class="bg-gray-100 text-gray-800">

<div class="container mx-auto p-4 max-w-4xl">
    <header class="text-center my-8">
        <h1 class="text-4xl font-bold typewriter inline-block p-2">TypeFlow</h1>
    </header>

    <div id="prefContainer" class="bg-white shadow-lg rounded-lg p-6 mb-8">
        <div class="flex flex-wrap -mx-2">
            <div class="w-full md:w-1/3 px-2 mb-4">
                <label class="block text-sm font-bold mb-2">Source</label>
                <div class="space-y-2">
                    <label class="flex items-center"><input type="radio" id="defaultText" name="source" value="defaultText" class="mr-2"> Default</label>
                    <label class="flex items-center"><input type="radio" id="generateWikimedia" name="source" value="wikipedia" class="mr-2"> Wikipedia</label>
                    <label class="flex items-center"><input type="radio" id="generateGemini" name="source" value="gemini" class="mr-2"> Gemini</label>
                </div>
                <p id="sourceError" class="text-red-500 text-xs mt-1 hidden">Select a source.</p>
            </div>
            <div class="w-full md:w-1/3 px-2 mb-4">
                <label for="topicSearch" class="block text-sm font-bold mb-2">Topic</label>
                <input type="text" name="topic" id="topicSearch" class="w-full p-2 border rounded" disabled>
                <p id="topicError" class="text-red-500 text-xs mt-1 hidden">Enter a topic.</p>
            </div>
            <div class="w-full md:w-1/3 px-2 mb-4">
                <label for="difficulty" class="block text-sm font-bold mb-2">Difficulty</label>
                <select id="difficulty" name="difficulty" class="w-full p-2 border rounded">
                    <option value="easy">Easy</option>
                    <option value="medium">Medium</option>
                    <option value="hard">Hard</option>
                </select>
                <p id="difficultyError" class="text-red-500 text-xs mt-1 hidden">Select difficulty.</p>
            </div>
        </div>
        <button id="confirm" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600 transition duration-300">Start</button>
    </div>

    <div id="mainContainer" class="hidden">
        <div id="reftext" class="bg-white shadow-lg rounded-lg p-4 mb-4 h-46 overflow-y-auto text-md flex flex-wrap justify-center"></div>

        <div class="flex justify-between items-center mb-4">
            <div id="timer" class="text-2xl font-bold">00:00</div>
            <button id="start" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition duration-300">Begin</button>
        </div>

        <input type="text" id="textinput" class="w-full p-2 border rounded mb-4" placeholder="Type here...">

        <div class="grid grid-cols-3 gap-4 text-center mb-4">
            <div class="bg-white shadow rounded p-2">
                <p class="text-xs">Input Chars</p>
                <span id="inpchars" class="text-lg font-bold">0</span>
            </div>
            <div class="bg-white shadow rounded p-2">
                <p class="text-xs">Total Words</p>
                <span id="totalwords" class="text-lg font-bold">0</span>
            </div>
            <div class="bg-white shadow rounded p-2">
                <p class="text-xs">Total Chars</p>
                <span id="totalchars" class="text-lg font-bold">0</span>
            </div>
        </div>

        <div id="resultsContainer" class="hidden bg-white shadow-lg rounded-lg p-4">
            <h3 class="text-xl font-bold mb-2">Results</h3>
            <div class="grid grid-cols-2 gap-4 text-sm">
                <div>
                    <p>Correct characters: <span id="correct_chars" class="font-bold"></span></p>
                    <p>Correct words: <span id="correct_words" class="font-bold"></span></p>
                </div>
                <div>
                    <p>Words per minute: <span id="wpm" class="font-bold"></span></p>
                    <p>Time record: <span id="time_record" class="font-bold"></span></p>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="importmap">
    {
      "imports": {
        "@google/generative-ai": "https://esm.run/@google/generative-ai"
      }
    }
</script>
<script>
    function logVisitor() {
        fetch('log_visitor.php')
            .then(response => response.text())
            .then(data => console.log(data))
            .catch(error => console.error('Error logging visitor:', error));
    }

    window.onload = logVisitor;
</script>
<script src="JS_Files/DOM.js" type="module"></script>
<script src="JS_Files/getPreferences.js" type="module"></script>
<script src="JS_Files/processPreferences.js" type="module"></script>
<script src="JS_Files/fetchLocal.js" type="module"></script>
<script src="JS_Files/fetchRemote_Wikimedia.js" type="module"></script>
<script src="JS_Files/fetchRemote_Gemini.js" type="module"></script>
<script src="JS_Files/statistics.js" type="module"></script>
<script src="JS_Files/displayRefText.js" type="module"></script>
<script src="JS_Files/time_management.js" type="module"></script>
<script src="JS_Files/verfiy.js" type="module"></script>
</body>
</html>